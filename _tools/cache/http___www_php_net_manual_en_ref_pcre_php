<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head profile="http://purl.org/NET/erdf/profile">
 <title>PHP: PCRE Functions - Manual</title>
 <style type="text/css" media="all">
  @import url("http://static.php.net/www.php.net/styles/site.css");
  @import url("http://static.php.net/www.php.net/styles/phpnet.css");
 </style>
 <!--[if IE]><![if gte IE 6]><![endif]-->
  <style type="text/css" media="print">
   @import url("http://static.php.net/www.php.net/styles/print.css");
  </style>
 <!--[if IE]><![endif]><![endif]-->
 <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
 <link rel="shortcut icon" href="http://static.php.net/www.php.net/favicon.ico" />
 <link rel="contents" href="index.php" />
 <link rel="index" href="book.pcre.php" />
 <link rel="prev" href="book.pcre.php" />
 <link rel="next" href="function.preg-grep.php" />
 <link rel="schema.dc" href="http://purl.org/dc/elements/1.1/" />
 <link rel="schema.rdfs" href="http://www.w3.org/2000/01/rdf-schema#" />
 <script type="text/javascript" src="http://static.php.net/www.php.net/userprefs.js"></script>
 <base href="http://www.php.net/manual/en/ref.pcre.php" />
</head>
<body>

<div id="headnav">
 <a href="/" rel="home"><img src="http://static.php.net/www.php.net/images/php.gif"
 alt="PHP" width="120" height="67" /></a>
 <div id="headmenu">
  <a href="/downloads.php">downloads</a> |
  <a href="/docs.php">documentation</a> |
  <a href="/FAQ.php">faq</a> |
  <a href="/support.php">getting help</a> |
  <a href="/mailing-lists.php">mailing lists</a> |
  <a href="http://bugs.php.net/">reporting bugs</a> |
  <a href="/sites.php">php.net sites</a> |
  <a href="/links.php">links</a> |
  <a href="/conferences/">conferences</a> |
  <a href="/my.php">my php.net</a>
 </div>
</div>

<div id="headsearch">
 <form method="post" action="/search.php" id="topsearch">
  <p>
   <span title="Keyboard shortcut: Alt+S (Win), Ctrl+S (Apple)">
    <span class="shortkey">s</span>earch for
   </span>
   <input type="text" name="pattern" value="" size="30" accesskey="s" />
   <span>in the</span>
   <select name="show">
    <option value="quickref" selected="selected">function list</option>
    <option value="all"      >all php.net sites</option>
    <option value="local"    >this mirror only</option>
    <option value="manual"   >online documentation</option>
    <option value="bugdb"    >bug database</option>
    <option value="news_archive">Site News Archive</option>
    <option value="changelogs">All Changelogs</option>
    <option value="pear"     >just pear.php.net</option>
    <option value="pecl"     >just pecl.php.net</option>
    <option value="talks"    >just talks.php.net</option>
    <option value="maillist" >general mailing list</option>
    <option value="devlist"  >developer mailing list</option>
    <option value="phpdoc"   >documentation mailing list</option>
   </select>
   <input type="image"
          src="http://static.php.net/www.php.net/images/small_submit_white.gif"
          class="submit" alt="search" />
   <input type="hidden" name="lang" value="en" />
  </p>
 </form>
</div>

<div id="layout_2">
 <div id="leftbar">
<!--UdmComment-->
<ul class="toc">
 <li class="header home"><a href="index.php">PHP Manual</a></li>
 <li class="header up"><a href="funcref.php">Function Reference</a></li>
 <li class="header up"><a href="refs.basic.text.php">Text Processing</a></li>
 <li class="header up"><a href="book.pcre.php">Regular Expression Functions (Perl-Compatible)</a></li>
 <li><a href="intro.pcre.php">Introduction</a></li>
 <li><a href="pcre.setup.php">Installing/Configuring</a></li>
 <li><a href="pcre.constants.php">Predefined Constants</a></li>
 <li><a href="pcre.examples.php">Examples</a></li>
 <li><a href="pcre.pattern.php">PCRE Patterns</a></li>
 <li class="active"><a href="ref.pcre.php">PCRE Functions</a></li>
</ul><!--/UdmComment-->

 </div>
 <div id="content" class="manual/en">
<!--UdmComment-->
<div class="manualnavbar manualnavbar_top">
 <span class="next">
  <a href="function.preg-grep.php">preg_grep<img src="http://static.php.net/www.php.net/images/caret-r.gif" alt="&gt;" width="11" height="7" /></a>
 </span>
 <span class="prev">
  <a href="book.pcre.php"><img src="http://static.php.net/www.php.net/images/caret-l.gif" alt="&lt;" width="11" height="7" />PCRE</a>
 </span>
 <hr />
 <span class="lastupdated">Last updated: Fri, 11 Apr 2008</span>
 <div class="langchooser">
  <form action="/manual/change.php" method="get">
   <p>view this page in </p><fieldset><select name="page">
    <option value="bg/ref.pcre.php">Bulgarian</option>
    <option value="pt_BR/ref.pcre.php">Brazilian Portuguese</option>
    <option value="fr/ref.pcre.php">French</option>
    <option value="de/ref.pcre.php">German</option>
    <option value="it/ref.pcre.php">Italian</option>
    <option value="ja/ref.pcre.php">Japanese</option>
    <option value="pl/ref.pcre.php">Polish</option>
    <option value="ro/ref.pcre.php">Romanian</option>
    <option value="ru/ref.pcre.php">Russian</option>
    <option value="es/ref.pcre.php">Spanish</option>
    <option value="help-translate.php">Other</option>
   </select>
   <input type="image" src="http://static.php.net/www.php.net/images/small_submit.gif" id="changeLangImage" alt="" />
  </fieldset></form>
 </div>
</div>
<!--/UdmComment-->

<div>
 <h1 class="title">PCRE Functions</h1>

 

















































<h2>Table of Contents</h2><ul class="chunklist chunklist_reference"><li><a href="function.preg-grep.php">preg_grep</a> — Return array entries that match the pattern</li><li><a href="function.preg-last-error.php">preg_last_error</a> — Returns the error code of the last PCRE regex execution</li><li><a href="function.preg-match-all.php">preg_match_all</a> — Perform a global regular expression match</li><li><a href="function.preg-match.php">preg_match</a> — Perform a regular expression match</li><li><a href="function.preg-quote.php">preg_quote</a> — Quote regular expression characters</li><li><a href="function.preg-replace-callback.php">preg_replace_callback</a> — Perform a regular expression search and replace using a callback</li><li><a href="function.preg-replace.php">preg_replace</a> — Perform a regular expression search and replace</li><li><a href="function.preg-split.php">preg_split</a> — Split string by a regular expression</li></ul>
</div>
<br /><br /><!--UdmComment-->
<div class="manualnavbar manualnavbar_bottom">
 <span class="next">
  <a href="function.preg-grep.php">preg_grep<img src="http://static.php.net/www.php.net/images/caret-r.gif" alt="&gt;" width="11" height="7" /></a>
 </span>
 <span class="prev">
  <a href="book.pcre.php"><img src="http://static.php.net/www.php.net/images/caret-l.gif" alt="&lt;" width="11" height="7" />PCRE</a>
 </span>
 <hr />
 <span class="lastupdated">Last updated: Fri, 11 Apr 2008</span>
 <div class="langchooser">
  &nbsp;
 </div>
</div>
<!--/UdmComment-->


<div id="usernotes">
 <div class="head">
  <span class="action"><a href="/manual/add-note.php?sect=ref.pcre&amp;redirect=http://www.php.net/manual/en/ref.pcre.php"><img src="http://static.php.net/www.php.net/images/notes-add.gif" alt="add a note" width="13" height="13" align="middle" /></a> <small><a href="/manual/add-note.php?sect=ref.pcre&amp;redirect=http://www.php.net/manual/en/ref.pcre.php">add a note</a></small></span>
  <small>User Contributed Notes</small><br />
  <strong>PCRE Functions</strong>
 </div>
 <a name="82404"></a>
 <div class="note">
  <strong>Jonathan dot Daigle at example dot com</strong><br />
  <a href="#82404">09-Apr-2008 07:39</a>
  <div class="text">
<div class="phpcode"><code><span class="html">
In answer to "me at codingbear.com"<br />
<br />
You can achieve the same result in a way that at my sense is easier.<br />
<br />
However, If you have a custom error handler already set $php_errormsg wont be populated and you will have to retreive your last error from your custom error handler.<br />
&nbsp;<br />
<span class="default">&lt;?php<br />
</span><span class="comment">/**<br />
&nbsp;* The RegEx validation class .<br />
&nbsp;*<br />
&nbsp;* Usage:<br />
&nbsp;* if (!RegEx::isValid($expression)) {<br />
&nbsp;*&nbsp; &nbsp; echo 'Your regular expression is invalid because: ' . RegEx::error();<br />
&nbsp;* }<br />
&nbsp;*/<br />
</span><span class="keyword">class </span><span class="default">RegEx </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * Validates a regular expression. Returns TRUE<br />
&nbsp;&nbsp; &nbsp; * if the expression is valid, FALSE if not. If<br />
&nbsp;&nbsp; &nbsp; * the expression is not valid, the reason why<br />
&nbsp;&nbsp; &nbsp; * can be fetched from RegEx::error().<br />
&nbsp;&nbsp; &nbsp; *<br />
&nbsp;&nbsp; &nbsp; * @access public<br />
&nbsp;&nbsp; &nbsp; * @static<br />
&nbsp;&nbsp; &nbsp; * @param string $regex Regular Expression<br />
&nbsp;&nbsp; &nbsp; * @return bool<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">isValid</span><span class="keyword">(</span><span class="default">$regex</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">self</span><span class="keyword">::</span><span class="default">error</span><span class="keyword">(</span><span class="default">FALSE</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$nbMatch </span><span class="keyword">= </span><span class="default">FALSE</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$nbMatch </span><span class="keyword">= @</span><span class="default">preg_match</span><span class="keyword">(</span><span class="default">$regex</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$nbMatch </span><span class="keyword">=== </span><span class="default">FALSE</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">self</span><span class="keyword">::</span><span class="default">error</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$php_errormsg</span><span class="keyword">, </span><span class="default">14</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">FALSE</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">TRUE</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * Holds the error from the last validation check.<br />
&nbsp;&nbsp; &nbsp; *<br />
&nbsp;&nbsp; &nbsp; * The first parameter is used internally and should<br />
&nbsp;&nbsp; &nbsp; * not be used by the developer.<br />
&nbsp;&nbsp; &nbsp; *<br />
&nbsp;&nbsp; &nbsp; * @access public<br />
&nbsp;&nbsp; &nbsp; * @static<br />
&nbsp;&nbsp; &nbsp; * @param FALSE|string $value value to set for $flag<br />
&nbsp;&nbsp; &nbsp; * @return FALSE|string<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">error</span><span class="keyword">(</span><span class="default">$value </span><span class="keyword">= </span><span class="default">NULL</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; static </span><span class="default">$flag </span><span class="keyword">= </span><span class="default">FALSE</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!</span><span class="default">is_null</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$flag </span><span class="keyword">= </span><span class="default">$value</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$flag</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
 <a name="80221"></a>
 <div class="note">
  <strong>me at codingbear.com</strong><br />
  <a href="#80221">04-Jan-2008 07:58</a>
  <div class="text">
<div class="phpcode"><code><span class="html">
While developing an application I needed to take user-entered regular expressions and validate them before use. Since I was unable to find a built-in function for doing so, I wrote this piece of code.<br />
<br />
It works by setting an error handler then using the provided regular expression on an empty string. If the regular expression is invalid then preg_match will create an error which is captured by the error handler. The error handler is then restored.<br />
<br />
It is possible to generalize this for any function by modifying isValid() to accept a function/method name and the appropriate parameters instead.<br />
<br />
For aesthetics, the preg_match(): part of the error is stripped out.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">/**<br />
&nbsp;* The RegEx validation class .<br />
&nbsp;* <br />
&nbsp;* Usage:<br />
&nbsp;* if (!RegEx::isValid($expression)) {<br />
&nbsp;*&nbsp; &nbsp; echo 'Your regular expression is invalid because: ' . RegEx::error();<br />
&nbsp;* }<br />
&nbsp;*/<br />
</span><span class="keyword">class </span><span class="default">RegEx </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * Validates a regular expression. Returns TRUE<br />
&nbsp;&nbsp; &nbsp; * if the expression is valid, FALSE if not. If<br />
&nbsp;&nbsp; &nbsp; * the expression is not valid, the reason why<br />
&nbsp;&nbsp; &nbsp; * can be fetched from RegEx::error().<br />
&nbsp;&nbsp; &nbsp; * <br />
&nbsp;&nbsp; &nbsp; * @access public<br />
&nbsp;&nbsp; &nbsp; * @static<br />
&nbsp;&nbsp; &nbsp; * @param string $regex Regular Expression<br />
&nbsp;&nbsp; &nbsp; * @return bool<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">isValid</span><span class="keyword">(</span><span class="default">$regex</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">RegEx</span><span class="keyword">::</span><span class="default">error</span><span class="keyword">(</span><span class="default">FALSE</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">set_error_handler</span><span class="keyword">(array(</span><span class="string">'RegEx'</span><span class="keyword">, </span><span class="string">'errorHandler'</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">preg_match</span><span class="keyword">(</span><span class="default">$regex</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">restore_error_handler</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return (</span><span class="default">RegEx</span><span class="keyword">::</span><span class="default">error</span><span class="keyword">() === </span><span class="default">FALSE</span><span class="keyword">) ? </span><span class="default">TRUE </span><span class="keyword">: </span><span class="default">FALSE</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * Error handler for RegEx. Used internally by RegEx::validate()<br />
&nbsp;&nbsp; &nbsp; * <br />
&nbsp;&nbsp; &nbsp; * @access package<br />
&nbsp;&nbsp; &nbsp; * @static<br />
&nbsp;&nbsp; &nbsp; * @param int $code Error Code<br />
&nbsp;&nbsp; &nbsp; * @param string $message Error Message<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">errorHandler</span><span class="keyword">(</span><span class="default">$code</span><span class="keyword">, </span><span class="default">$message</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Cuts off the 'preg_match(): ' part of the error message.<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$error </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$message</span><span class="keyword">, </span><span class="default">14</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Sets the error flag with the message.<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">RegEx</span><span class="keyword">::</span><span class="default">error</span><span class="keyword">(</span><span class="default">$error</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * Holds the error from the last validation check.<br />
&nbsp;&nbsp; &nbsp; * <br />
&nbsp;&nbsp; &nbsp; * The first parameter is used internally and should<br />
&nbsp;&nbsp; &nbsp; * not be used by the developer.<br />
&nbsp;&nbsp; &nbsp; * <br />
&nbsp;&nbsp; &nbsp; * @access public<br />
&nbsp;&nbsp; &nbsp; * @static <br />
&nbsp;&nbsp; &nbsp; * @param FALSE|string $value value to set for $flag<br />
&nbsp;&nbsp; &nbsp; * @return FALSE|string<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">error</span><span class="keyword">(</span><span class="default">$value </span><span class="keyword">= </span><span class="default">NULL</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; static </span><span class="default">$flag </span><span class="keyword">= </span><span class="default">FALSE</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!</span><span class="default">is_null</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$flag </span><span class="keyword">= </span><span class="default">$value</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$flag</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
 <a name="79862"></a>
 <div class="note">
  <strong>tom at bitworks dot de</strong><br />
  <a href="#79862">16-Dec-2007 04:33</a>
  <div class="text">
<div class="phpcode"><code><span class="html">
I am quiet astonished experiencing, that a point does NOT match umlauts and other 'special' characters, in spite of the fact, it is written in this documentation.<br />
<br />
I could not fathom out yet, which characters also are affected, but it seams to be better everybody else takes care of that incompatible behavior to perl.</span>
</code></div>
  </div>
 </div>
 <a name="77790"></a>
 <div class="note">
  <strong>stronk7 at moodle dot org</strong><br />
  <a href="#77790">13-Sep-2007 01:42</a>
  <div class="text">
<div class="phpcode"><code><span class="html">
One comment about 5.2.x and the pcre.backtrack_limit:<br />
<br />
Note that this setting wasn't present under previous PHP releases and the behaviour (or limit) under those releases was, in practise,&nbsp; higher so all these PCRE functions were able to "capture" longer strings.<br />
<br />
With the arrival of the setting, defaulting to 100000 (less than 100K), you won't be able to match/capture strings over that size using, for example "ungreedy" modifiers.<br />
<br />
So, in a lot of situations, you'll need to raise that (very small IMO) limit.<br />
<br />
The worst part is that PHP simply won't match/capture those strings over pcre.backtrack_limit and will it be 100% silent about that (I think that throwing some NOTICE/WARNING if raised could help a lot to developers).<br />
<br />
There is a lot of people suffering this changed behaviour from I've read on forums, bugs and so on).<br />
<br />
Hope this note helps, ciao :-)</span>
</code></div>
  </div>
 </div>
 <a name="74939"></a>
 <div class="note">
  <strong>misc at e2007 dot cynergi dot com</strong><br />
  <a href="#74939">05-May-2007 04:16</a>
  <div class="text">
<div class="phpcode"><code><span class="html">
PCRE faster than POSIX RE? Not always.<br />
<br />
In a recent search-engine project here at Cynergi, I had a simple loop with a few cute ereg_replace() functions that took 3min to process data. I changed that 10-line loop into a 100-line hand-written code for replacement and the loop now took 10s to process the same data! This opened my eye to what can *IN SOME CASES* be very slow regular expressions.<br />
<br />
Lately I decided to look into Perl-compatible regular expressions (PCRE). Most pages claim PCRE are faster than POSIX, but a few claim otherwise. I decided on bechmarks of my own.<br />
<br />
My first few tests confirmed PCRE to be faster, but... the results were slightly different than others were getting, so I decided to benchmark every case of RE usage I had on a 8000-line secure (and fast) Webmail project here at Cynergi to check it out.<br />
<br />
The results? Inconclusive! Sometimes PCRE *are* faster (sometimes by a factor greater than 100x faster!), but some other times POSIX RE are faster (by a factor of 2x).<br />
<br />
I still have to find a rule on when are one or the other faster. It's not only about search data size, amount of data matched, or "RE compilation time" which would show when you repeated the function often: one would *always* be faster than the other. But I didn't find a pattern here. But truth be said, I also didn't take the time to look into the source code and analyse the problem.<br />
<br />
I can give you some examples, though. The POSIX RE<br />
<br />
([0-9]{4})/([0-9]{2})/([0-9]{2})[^0-9]+<br />
([0-9]{2}):([0-9]{2}):([0-9]{2})<br />
<br />
is 30% faster in POSIX than when converted to PCRE (even if you use \d and \D and non-greedy matching). On the other hand, a similarly PCRE complex pattern<br />
<br />
/[0-9]{1,2}[ \t]+[a-zA-Z]{3}[ \t]+[0-9]{4}[ \t]+[0-9]{1,2}:[0-9]{1,2}(:[0-9]{1,2})?[ \t]+[+-][0-9]{4}/<br />
<br />
is 2.5x faster in PCRE than in POSIX RE. Simple replacement patterns like<br />
<br />
ereg_replace( "[^a-zA-Z0-9-]+", "", $m );<br />
<br />
are 2x faster in POSIX RE than PCRE. And then we get confused again because a POSIX RE pattern like<br />
<br />
(^|\n|\r)begin-base64[ \t]+[0-7]{3,4}[ \t]+......<br />
<br />
is 2x faster as POSIX RE, but the case-insensitive PCRE<br />
<br />
/^Received[ \t]*:[ \t]*by[ \t]+([^ \t]+)[ \t]/i<br />
<br />
is 30x faster than its POSIX RE version!<br />
<br />
When it comes to case sensitivity, PCRE has so far seemed to be the best option. But I found some really strange behaviour from ereg/eregi. On a very simple POSIX RE<br />
<br />
(^|\r|\n)mime-version[ \t]*:<br />
<br />
I found eregi() taking 3.60s (just a number in a test benchmark), while the corresponding PCRE took 0.16s! But if I used ereg() (case-sensitive) the POSIX RE time went down to 0.08s! So I investigated further. I tried to make the POSIX RE case-insensitive itself. I got as far as this:<br />
<br />
(^|\r|\n)[mM][iI][mM][eE]-vers[iI][oO][nN][ \t]*:<br />
<br />
This version also took 0.08s. But if I try to apply the same rule to any of the 'v', 'e', 'r' or 's' letters that are not changed, the time is back to the 3.60s mark, and not gradually, but immediatelly so! The test data didn't have any "vers" in it, other "mime" words in it or any "ion" that might be confusing the POSIX parser, so I'm at a loss.<br />
<br />
Bottom line: always benchmark your PCRE / POSIX RE to find the fastest!<br />
<br />
Tests were performed with PHP 5.1.2 under Windows, from the command line.<br />
<br />
Pedro Freire<br />
cynergi.com</span>
</code></div>
  </div>
 </div>
 <a name="62092"></a>
 <div class="note">
  <strong>lgandras at hotmail dot com</strong><br />
  <a href="#62092">19-Feb-2006 02:19</a>
  <div class="text">
<div class="phpcode"><code><span class="html">
I read this part, but i couldn't undertand a single word beacause before i must know Basic regular expression. Somebody put a link for PERL that is almost like PHP but here is one totally dedicated to PHP:<br />
<br />
<a href="http://weblogtoolscollection.com/regex/regex.php" target="_blank">http://weblogtoolscollection.com/regex/regex.php</a></span>
</code></div>
  </div>
 </div>
 <a name="57073"></a>
 <div class="note">
  <strong>richardh at phpguru dot org</strong><br />
  <a href="#57073">22-Sep-2005 11:50</a>
  <div class="text">
<div class="phpcode"><code><span class="html">
There's a printable PDF PCRE cheat sheet available here:<br />
<br />
<a href="http://www.phpguru.org/article.php?ne_id=67" target="_blank">http://www.phpguru.org/article.php?ne_id=67</a><br />
<br />
Has the common metacharacters, quantifiers, pattern modifiers, character classes and assertions with short explanations.</span>
</code></div>
  </div>
 </div>
 <a name="46798"></a>
 <div class="note">
  <strong>Ned Baldessin</strong><br />
  <a href="#46798">23-Oct-2004 06:08</a>
  <div class="text">
<div class="phpcode"><code><span class="html">
If you want to perform regular expressions on Unicode strings, the PCRE functions will NOT be of any help. You need to use the Multibyte extension : mb_ereg(), mb_eregi(), pb_ereg_replace() and so on. When doing so, be carefull to set the default text encoding to the same encoding used by the text you are searching and replacing in. You can do that with the mb_regex_encoding() function. You will probably also want to set the default encoding for the other mb_* string functions with mb_internal_encoding().<br />
<br />
So when dealing with, say, french text, I start with these :<br />
<span class="default">&lt;?php<br />
mb_internal_encoding</span><span class="keyword">(</span><span class="string">'UTF-8'</span><span class="keyword">);<br />
</span><span class="default">mb_regex_encoding</span><span class="keyword">(</span><span class="string">'UTF-8'</span><span class="keyword">);<br />
</span><span class="default">setlocale</span><span class="keyword">(</span><span class="default">LC_ALL</span><span class="keyword">, </span><span class="string">'fr-fr'</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
 <a name="44274"></a>
 <div class="note">
  <strong>steve at stevedix dot de</strong><br />
  <a href="#44274">20-Jul-2004 05:17</a>
  <div class="text">
<div class="phpcode"><code><span class="html">
Something to bear in mind is that regex is actually a declarative programming language like prolog : your regex is a set of rules which the regex interpreter tries to match against a string.&nbsp;&nbsp; During this matching, the interpreter will assume certain things, and continue assuming them until it comes up against a failure to match, which then causes it to backtrack.&nbsp; Regex assumes "greedy matching" unless explicitly told not to, which can cause a lot of backtracking.&nbsp; A general rule of thumb is that the more backtracking, the slower the matching process.<br />
<br />
It is therefore vital, if you are trying to optimise your program to run quickly (and if you can't do without regex), to optimise your regexes to match quickly.<br />
<br />
I recommend the use of a tool such as "The Regex Coach" to debug your regex strings.<br />
<br />
<a href="http://weitz.de/files/regex-coach.exe" target="_blank">http://weitz.de/files/regex-coach.exe</a> (Windows installer) <a href="http://weitz.de/files/regex-coach.tgz" target="_blank">http://weitz.de/files/regex-coach.tgz</a> (Linux tar archive)</span>
</code></div>
  </div>
 </div>
 <a name="35966"></a>
 <div class="note">
  <strong>Biju</strong><br />
  <a href="#35966">20-Sep-2003 09:00</a>
  <div class="text">
<div class="phpcode"><code><span class="html">
Regular Expressions Tutorial from non PHP sites<br />
&nbsp;&nbsp; <a href="http://www.amk.ca/python/howto/regex/" target="_blank">http://www.amk.ca/python/howto/regex/</a><br />
&nbsp;&nbsp; <a href="http://sitescooper.org/tao_regexps.html" target="_blank">http://sitescooper.org/tao_regexps.html</a><br />
&nbsp;&nbsp; <a href="http://www.english.uga.edu/humcomp/perl/regex2a.html" target="_blank">http://www.english.uga.edu/humcomp/perl/regex2a.html</a><br />
&nbsp;&nbsp; <a href="http://www.english.uga.edu/humcomp/perl/regexps.html" target="_blank">http://www.english.uga.edu/humcomp/perl/regexps.html</a><br />
&nbsp;&nbsp; <a href="http://www.english.uga.edu/humcomp/perl/regular_expressions.HTML" target="_blank">http://www.english.uga.edu/humcomp/perl/regular_expressions.HTML</a><br />
&nbsp;&nbsp; <a href="http://www.english.uga.edu/humcomp/perl/" target="_blank">http://www.english.uga.edu/humcomp/perl/</a><br />
&nbsp;&nbsp; <a href="http://java.sun.com/docs/books/tutorial/extra/regex/" target="_blank">http://java.sun.com/docs/books/tutorial/extra/regex/</a><br />
&nbsp;&nbsp; <a href="http://gnosis.cx/publish/programming/regular_expressions.html" target="_blank">http://gnosis.cx/publish/programming/regular_expressions.html</a><br />
&nbsp;&nbsp; <a href="http://www.zvon.org/other/PerlTutorial/Books/Book1/" target="_blank">http://www.zvon.org/other/PerlTutorial/Books/Book1/</a><br />
&nbsp;&nbsp; <a href="http://it.metr.ou.edu/regex/" target="_blank">http://it.metr.ou.edu/regex/</a><br />
&nbsp;&nbsp; <a href="http://www.regular-expressions.info/" target="_blank">http://www.regular-expressions.info/</a></span>
</code></div>
  </div>
 </div>
 <div class="foot"><a href="/manual/add-note.php?sect=ref.pcre&amp;redirect=http://www.php.net/manual/en/ref.pcre.php"><img src="http://static.php.net/www.php.net/images/notes-add.gif" alt="add a note" width="13" height="13" align="middle" /></a> <small><a href="/manual/add-note.php?sect=ref.pcre&amp;redirect=http://www.php.net/manual/en/ref.pcre.php">add a note</a></small></div>
</div><br /><!--UdmComment-->
<div class="manualnavbar manualnavbar_bottom">
 <span class="next">
  <a href="function.preg-grep.php">preg_grep<img src="http://static.php.net/www.php.net/images/caret-r.gif" alt="&gt;" width="11" height="7" /></a>
 </span>
 <span class="prev">
  <a href="book.pcre.php"><img src="http://static.php.net/www.php.net/images/caret-l.gif" alt="&lt;" width="11" height="7" />PCRE</a>
 </span>
 <hr />
 <span class="lastupdated">Last updated: Fri, 11 Apr 2008</span>
 <div class="langchooser">
  &nbsp;
 </div>
</div>
<!--/UdmComment-->


 </div>
 <div class="cleaner">&nbsp;</div>
</div>

<div id="footnav">
   <a href="/source.php?url=/manual/en/ref.pcre.php">show source</a> |
 <a href="/credits.php">credits</a> |
 <a href="/stats/">stats</a> |
 <a href="/sitemap.php">sitemap</a> |
 <a href="/contact.php">contact</a> |
 <a href="/contact.php#ads">advertising</a> |
 <a href="/mirrors.php">mirror sites</a>
</div>

<div id="pagefooter">
 <div id="copyright">
  <a href="/copyright.php">Copyright &copy; 2001-2008 The PHP Group</a><br />
  All rights reserved.
 </div>

 <div id="thismirror">
  <a href="/mirror.php">This mirror</a> generously provided by:
  <a href="http://developer.yahoo.com/">Yahoo! Inc.</a><br />
  Last updated: Wed Apr 16 05:27:53 2008 PDT
 </div>
</div>

</body>
</html>