---
examples:
  - - "addcslashes('foo[ ]', 'A..z'); // Escape all ASCII within capital A to lower z range, including square brackets"
  - - "addcslashes(\"zoo['.']\", 'z..A'); // Only escape z, period, and A here since not a lower-to-higher range"
  - - "addcslashes(\"@a\\u0000\\u0010\\u00A9\", \"\\0..\\37!@\\177..\\377\"); // Escape as octals those specified and less than 32 (0x20) or greater than 126 (0x7E), but not otherwise"
  - - "addcslashes(\"\\u0020\\u007E\", \"\\40..\\175\"); // Those between 32 (0x20 or 040) and 126 (0x7E or 0176) decimal value will be backslashed if specified (not octalized)"
  - - "addcslashes(\"\\r\\u0007\\n\", '\\0..\\37'); // Recognize C escape sequences if specified"
  - - "addcslashes(\"\\r\\u0007\\n\", '\\0'); // Do not recognize C escape sequences if not specified"
returns:
  - - "\"\\\\f\\\\o\\\\o\\\\[ \\\\]\""
  - - "\"\\\\zoo['\\\\.']\""
  - - "'\\\\@a\\\\000\\\\020\\\\302\\\\251'"
  - - "'\\\\ ~'"
  - - "\"\\\\r\\\\a\\\\n\""
  - - "\"\\r\\u0007\\n\""
authors:
  original by:
    - 'Brett Zamir (http://brett-zamir.me)'
notes: []
layout: function
function: addcslashes
category: strings
code: "function addcslashes (str, charlist) {\n  //  discuss at: http://phpjs.org/functions/addcslashes/\n  // original by: Brett Zamir (http://brett-zamir.me)\n  //        note: We show double backslashes in the return value example code below because a JavaScript string will not\n  //        note: render them as backslashes otherwise\n  //   example 1: addcslashes('foo[ ]', 'A..z'); // Escape all ASCII within capital A to lower z range, including square brackets\n  //   returns 1: \"\\\\f\\\\o\\\\o\\\\[ \\\\]\"\n  //   example 2: addcslashes(\"zoo['.']\", 'z..A'); // Only escape z, period, and A here since not a lower-to-higher range\n  //   returns 2: \"\\\\zoo['\\\\.']\"\n  //   example 3: addcslashes(\"@a\\u0000\\u0010\\u00A9\", \"\\0..\\37!@\\177..\\377\"); // Escape as octals those specified and less than 32 (0x20) or greater than 126 (0x7E), but not otherwise\n  //   returns 3: '\\\\@a\\\\000\\\\020\\\\302\\\\251'\n  //   example 4: addcslashes(\"\\u0020\\u007E\", \"\\40..\\175\"); // Those between 32 (0x20 or 040) and 126 (0x7E or 0176) decimal value will be backslashed if specified (not octalized)\n  //   returns 4: '\\\\ ~'\n  //   example 5: addcslashes(\"\\r\\u0007\\n\", '\\0..\\37'); // Recognize C escape sequences if specified\n  //   returns 5: \"\\\\r\\\\a\\\\n\"\n  //   example 6: addcslashes(\"\\r\\u0007\\n\", '\\0'); // Do not recognize C escape sequences if not specified\n  //   returns 6: \"\\r\\u0007\\n\"\n\n  var target = '',\n    chrs = [],\n    i = 0,\n    j = 0,\n    c = '',\n    next = '',\n    rangeBegin = '',\n    rangeEnd = '',\n    chr = '',\n    begin = 0,\n    end = 0,\n    octalLength = 0,\n    postOctalPos = 0,\n    cca = 0,\n    escHexGrp = [],\n    encoded = '',\n    percentHex = /%([\\dA-Fa-f]+)/g\n  var _pad = function (n, c) {\n    if ((n = n + '')\n      .length < c) {\n      return new Array(++c - n.length)\n        .join('0') + n\n    }\n    return n\n  }\n\n  for (i = 0; i < charlist.length; i++) {\n    c = charlist.charAt(i)\n    next = charlist.charAt(i + 1)\n    if (c === '\\\\' && next && (/\\d/)\n      .test(next)) {\n      // Octal\n      rangeBegin = charlist.slice(i + 1)\n        .match(/^\\d+/)[0]\n      octalLength = rangeBegin.length\n      postOctalPos = i + octalLength + 1\n      if (charlist.charAt(postOctalPos) + charlist.charAt(postOctalPos + 1) === '..') {\n        // Octal begins range\n        begin = rangeBegin.charCodeAt(0)\n        if ((/\\\\\\d/)\n          .test(charlist.charAt(postOctalPos + 2) + charlist.charAt(postOctalPos + 3))) {\n          // Range ends with octal\n          rangeEnd = charlist.slice(postOctalPos + 3)\n            .match(/^\\d+/)[0]\n          // Skip range end backslash\n          i += 1\n        } else if (charlist.charAt(postOctalPos + 2)) {\n          // Range ends with character\n          rangeEnd = charlist.charAt(postOctalPos + 2)\n        } else {\n          throw 'Range with no end point'\n        }\n        end = rangeEnd.charCodeAt(0)\n        if (end > begin) {\n          // Treat as a range\n          for (j = begin; j <= end; j++) {\n            chrs.push(String.fromCharCode(j))\n          }\n        } else {\n          // Supposed to treat period, begin and end as individual characters only, not a range\n          chrs.push('.', rangeBegin, rangeEnd)\n        }\n        // Skip dots and range end (already skipped range end backslash if present)\n        i += rangeEnd.length + 2\n      } else {\n        // Octal is by itself\n        chr = String.fromCharCode(parseInt(rangeBegin, 8))\n        chrs.push(chr)\n      }\n      // Skip range begin\n      i += octalLength\n    } else if (next + charlist.charAt(i + 2) === '..') {\n      // Character begins range\n      rangeBegin = c\n      begin = rangeBegin.charCodeAt(0)\n      if ((/\\\\\\d/)\n        .test(charlist.charAt(i + 3) + charlist.charAt(i + 4))) {\n        // Range ends with octal\n        rangeEnd = charlist.slice(i + 4)\n          .match(/^\\d+/)[0]\n        // Skip range end backslash\n        i += 1\n      } else if (charlist.charAt(i + 3)) {\n        // Range ends with character\n        rangeEnd = charlist.charAt(i + 3)\n      } else {\n        throw 'Range with no end point'\n      }\n      end = rangeEnd.charCodeAt(0)\n      if (end > begin) {\n        // Treat as a range\n        for (j = begin; j <= end; j++) {\n          chrs.push(String.fromCharCode(j))\n        }\n      } else {\n        // Supposed to treat period, begin and end as individual characters only, not a range\n        chrs.push('.', rangeBegin, rangeEnd)\n      }\n      // Skip dots and range end (already skipped range end backslash if present)\n      i += rangeEnd.length + 2\n    } else {\n      // Character is by itself\n      chrs.push(c)\n    }\n  }\n\n  for (i = 0; i < str.length; i++) {\n    c = str.charAt(i)\n    if (chrs.indexOf(c) !== -1) {\n      target += '\\\\'\n      cca = c.charCodeAt(0)\n      if (cca < 32 || cca > 126) {\n        // Needs special escaping\n        switch (c) {\n          case '\\n':\n            target += 'n'\n            break\n          case '\\t':\n            target += 't'\n            break\n          case '\\u000D':\n            target += 'r'\n            break\n          case '\\u0007':\n            target += 'a'\n            break\n          case '\\v':\n            target += 'v'\n            break\n          case '\\b':\n            target += 'b'\n            break\n          case '\\f':\n            target += 'f'\n            break\n          default:\n          // target += _pad(cca.toString(8), 3);break; // Sufficient for UTF-16\n            encoded = encodeURIComponent(c)\n\n          // 3-length-padded UTF-8 octets\n            if ((escHexGrp = percentHex.exec(encoded)) !== null) {\n              target += _pad(parseInt(escHexGrp[1], 16)\n              .toString(8), 3) // already added a slash above\n            }\n            while ((escHexGrp = percentHex.exec(encoded)) !== null) {\n              target += '\\\\' + _pad(parseInt(escHexGrp[1], 16)\n              .toString(8), 3)\n            }\n            break\n        }\n      } else {\n        // Perform regular backslashed escaping\n        target += c\n      }\n    } else {\n      // Just add the character unescaped\n      target += c\n    }\n  }\n  return target\n}\n"
permalink: /functions/addcslashes/
redirect_from:
  - /functions/strings/addcslashes/
---

<!-- WARNING! This file is auto generated by `npm run web:inject`, do not edit by hand -->
