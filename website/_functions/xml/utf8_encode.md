---
examples:
  - - "utf8_encode('Kevin van Zonneveld');"
returns:
  - - "'Kevin van Zonneveld'"
authors:
  original by:
    - 'Webtoolkit.info (http://www.webtoolkit.info/)'
  improved by:
    - 'Kevin van Zonneveld (http://kevin.vanzonneveld.net)'
    - sowberry
    - Jack
    - Yves Sucaet
    - kirilloid
  bugfixed by:
    - Onno Marsman
    - Onno Marsman
    - Ulrich
    - Rafal Kukawski
    - kirilloid
notes: []
layout: function
function: utf8_encode
category: xml
code: "function utf8_encode (argString) {\n  //  discuss at: http://phpjs.org/functions/utf8_encode/\n  // original by: Webtoolkit.info (http://www.webtoolkit.info/)\n  // improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)\n  // improved by: sowberry\n  // improved by: Jack\n  // improved by: Yves Sucaet\n  // improved by: kirilloid\n  // bugfixed by: Onno Marsman\n  // bugfixed by: Onno Marsman\n  // bugfixed by: Ulrich\n  // bugfixed by: Rafal Kukawski\n  // bugfixed by: kirilloid\n  //   example 1: utf8_encode('Kevin van Zonneveld');\n  //   returns 1: 'Kevin van Zonneveld'\n\n  if (argString === null || typeof argString === 'undefined') {\n    return ''\n  }\n\n  // .replace(/\\r\\n/g, \"\\n\").replace(/\\r/g, \"\\n\");\n  var string = (argString + '')\n  var utftext = '',\n    start, end, stringl = 0\n\n  start = end = 0\n  stringl = string.length\n  for (var n = 0; n < stringl; n++) {\n    var c1 = string.charCodeAt(n)\n    var enc = null\n\n    if (c1 < 128) {\n      end++\n    } else if (c1 > 127 && c1 < 2048) {\n      enc = String.fromCharCode(\n        (c1 >> 6) | 192, (c1 & 63) | 128\n      )\n    } else if ((c1 & 0xF800) != 0xD800) {\n      enc = String.fromCharCode(\n        (c1 >> 12) | 224, ((c1 >> 6) & 63) | 128, (c1 & 63) | 128\n      )\n    } else {\n      // surrogate pairs\n      if ((c1 & 0xFC00) != 0xD800) {\n        throw new RangeError('Unmatched trail surrogate at ' + n)\n      }\n      var c2 = string.charCodeAt(++n)\n      if ((c2 & 0xFC00) != 0xDC00) {\n        throw new RangeError('Unmatched lead surrogate at ' + (n - 1))\n      }\n      c1 = ((c1 & 0x3FF) << 10) + (c2 & 0x3FF) + 0x10000\n      enc = String.fromCharCode(\n        (c1 >> 18) | 240, ((c1 >> 12) & 63) | 128, ((c1 >> 6) & 63) | 128, (c1 & 63) | 128\n      )\n    }\n    if (enc !== null) {\n      if (end > start) {\n        utftext += string.slice(start, end)\n      }\n      utftext += enc\n      start = end = n + 1\n    }\n  }\n\n  if (end > start) {\n    utftext += string.slice(start, stringl)\n  }\n\n  return utftext\n}\n"
permalink: /functions/utf8_encode/
redirect_from:
  - /functions/xml/utf8_encode/
---

<!-- WARNING! This file is auto generated by `npm run web:inject`, do not edit by hand -->
